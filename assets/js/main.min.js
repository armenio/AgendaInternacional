Date.prototype.getTimestamp=function(){return this.getTime()/1e3},function(a){a(document).ready(function(){var b=a("#element_date"),c=a("#element_city1"),d=a("#element_city2"),e=a("#result"),f=a("#feedback"),g=new Date,h=new Date;h.setFullYear(g.getFullYear()+1),b.datepicker({language:"pt-BR",datesDisabled:[],autoclose:!0,daysOfWeekDisabled:[0,6],startDate:g,endDate:h});var i=document.getElementById("element_city1"),j=document.getElementById("element_city2"),k={types:["(cities)"]},l=!1,m=new google.maps.places.Autocomplete(i,k);m.addListener("place_changed",function(){l=!0,m.getPlace().selected_address_label=a.trim(i.value),u()});var n=new google.maps.places.Autocomplete(j,k);n.addListener("place_changed",function(){l=!0,n.getPlace().selected_address_label=a.trim(j.value),u()});var o=function(a,b,c){var d=f.find(".alert");d.text(a),d.addClass("alert-"+c),d.removeClass("alert-"+b),f.removeClass("hidden")},p=function(a,b,c){var d=a>=12?"pm":"am";return a%=12,a=a||12,a=a<10?"0"+a:a,b=b<10?"0"+b:b,c=c<10?"0"+c:c,{hours:a,minutes:b,seconds:c,ampm:d,formatted:a+":"+b+":"+c+" "+d}},q=function(a,f){a=p(a,0,0),f=p(f,0,0);var g=b.datepicker("getFormattedDate"),h=e.find(".local1"),i=e.find(".local2");h.find(".city").text(c.val()),h.find(".date").text(g),h.find(".hours").text(a.hours+":"+a.minutes),h.find(".ampm").text(a.ampm),i.find(".city").text(d.val()),i.find(".date").text(g),i.find(".hours").text(f.hours+":"+f.minutes),i.find(".ampm").text(f.ampm),e.removeClass("hidden")},r=function(a){return!!(a&&a.geometry&&a.geometry.location)},s=function(b,c){return b=a.trim(b),!(!r(c)||""===b||!c.selected_address_label||c.selected_address_label!=b)},t=function(b,c){var d=null;if(!r(b))return d;var e=b.geometry.location;return a.ajax({async:!1,method:"GET",url:"https://maps.googleapis.com/maps/api/timezone/json",data:{location:e.lat()+","+e.lng(),timestamp:c,key:"AIzaSyBdKcOOJljK0GCbqaM5EzsSkJorY7ZLsFo"},dataType:"json",success:function(a){d=(a.rawOffset+a.dstOffset)/60/60}}),d},u=function(){e.addClass("hidden"),f.addClass("hidden");var g=b.datepicker("getDate");if(!g)return void(""!==a.trim(b.val())&&o("A data é inválida","success","danger"));g.setUTCHours(0);var h=g.getTimestamp(),i=m.getPlace(),j=n.getPlace(),k=c.val(),l=d.val(),p=t(i,h),r=t(j,h);if(null===p||!s(k,i))return void(""!==a.trim(k)&&o("Sua cidade é inválida","success","danger"));if(null===r||!s(l,j))return void(""!==a.trim(l)&&o("A cidade da outra pessoa é inválida","success","danger"));f.addClass("hidden");var u=Math.abs(p-r);u>9?o("Os horários são incompatíveis com "+u+" horas de diferença :d","success","danger"):(o("Os horários são compatíveis "+(0==u?"sem diferença de horário":"com "+(u<4?"apenas ":"")+u+" hora"+(u>1?"s":"")+" de diferença")+" :D","danger","success"),p>r?q(9,9+u):q(9+u,9),setTimeout(function(){a.scrollTo(f,600,{offset:{top:-100}})},600))},v=function(){setTimeout(function(){l||u(),l=!1},600)};b.on("changeDate",function(){u()}),c.on("blur",function(){v()}),d.on("blur",function(){v()})})}(jQuery);